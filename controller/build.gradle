apply plugin: 'scala'

sourceSets {
    main {
        scala {
            srcDirs = ['src/']
        }
        resources {
            srcDirs = ['src/']
        }
    }
}

dependencies {
    compile project(':common:scala')
}

task distDocker(dependsOn:distTar, type:Exec) {
    commandLine 'docker', 'build', '-t', 'whisk/' + project.name, '.'
}

mainClassName = "whisk.core.controller.Controller"
startScripts {
    doLast {
        def lines = unixScript.readLines()
        lines[lines.size()-1] = lines.last() + ' >> /logs/' + project.name + '_logs.log 2>&1'
        unixScript.text = lines.join("\n")
    }
}