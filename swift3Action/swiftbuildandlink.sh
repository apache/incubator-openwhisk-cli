#!/bin/bash

echo "Compiling"
/usr/bin/swiftc -module-name Action -suppress-warnings -incremental -emit-dependencies -emit-module -emit-module-path /swift3Action/spm-build/.build/release/Action.swiftmodule -output-file-map /swift3Action/spm-build/.build/release/Action.build/output-file-map.json -whole-module-optimization -num-threads 8 -c /swift3Action/spm-build/main.swift /swift3Action/spm-build/Whisk.swift -I /swift3Action/spm-build/.build/release -j8 -D SWIFT_PACKAGE -O -Xcc -fmodule-map-file=/swift3Action/spm-build/Packages/CCurl-0.2.1/module.modulemap -Xcc -fmodule-map-file=/swift3Action/spm-build/.build/release/CHTTPParser.build/module.modulemap -Xcc -fmodule-map-file=/swift3Action/spm-build/Packages/OpenSSL-0.2.2/module.modulemap -Xcc -fmodule-map-file=/swift3Action/spm-build/Packages/CEpoll-0.1.0/module.modulemap -Xcc -I/usr/include -L/usr/lib/x86_64-linux-gnu -lssl -lcrypto -module-cache-path /swift3Action/spm-build/.build/release/ModuleCache
swiftStatus=$?
echo swiftc status is $swiftStatus
if [[ "$swiftStatus" -eq "0" ]]; then
  echo "Linking"
  /usr/bin/swiftc -Xlinker '-rpath=$ORIGIN' '-L/swift3Action/spm-build/.build/release' -o '/swift3Action/spm-build/.build/release/Action' -emit-executable -Xcc -I/usr/include '-L/usr/lib/x86_64-linux-gnu' -lssl -lcrypto '/swift3Action/spm-build/.build/release/Action.build/main.swift.o' '/swift3Action/spm-build/.build/release/Action.build/Whisk.swift.o' '/swift3Action/spm-build/.build/release/LoggerAPI.build/Logger.swift.o' '/swift3Action/spm-build/.build/release/Socket.build/Socket.swift.o' '/swift3Action/spm-build/.build/release/Socket.build/SocketUtils.swift.o' '/swift3Action/spm-build/.build/release/Socket.build/SocketProtocols.swift.o' '/swift3Action/spm-build/.build/release/SSLService.build/SSLService.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/ClientResponse.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/ServerDelegate.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/BufferList.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/PseudoSynchronousReader.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/ServerRequest.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/IncomingSocketManager.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/IncomingSocketProcessor.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/Error.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/IncomingSocketHandler.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/ListenerGroup.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/HeadersContainer.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/ServerResponse.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/ClientRequest.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/SPIUtils.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/HTTP/IncomingHTTPSocketProcessor.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/HTTP/HTTPServerResponse.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/HTTP/HTTPServer.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/HTTP/HTTPServerRequest.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/HTTP/HTTPIncomingMessage.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/HTTP/HTTP.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/FastCGI/FastCGI.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/FastCGI/FastCGIServer.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/FastCGI/FastCGIServerResponse.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/FastCGI/FastCGIServerRequest.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/FastCGI/FastCGIRecordCreate.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/FastCGI/FastCGIRecordParser.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/HTTPParser/URLParser.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/HTTPParser/HTTPParser.swift.o' '/swift3Action/spm-build/.build/release/KituraNet.build/HTTPParser/HTTPParserStatus.swift.o' '/swift3Action/spm-build/.build/release/SwiftyJSON.build/SwiftyJSON.swift.o' '/swift3Action/spm-build/.build/release/SwiftyJSON.build/LclJSONSerialization.swift.o' '/swift3Action/spm-build/.build/release/RestKit.build/RestResult.swift.o' '/swift3Action/spm-build/.build/release/RestKit.build/RestRequest.swift.o' '/swift3Action/spm-build/.build/release/RestKit.build/RestError.swift.o' '/swift3Action/spm-build/.build/release/Conversation.build/Conversation.swift.o' '/swift3Action/spm-build/.build/release/Conversation.build/Models/MessageRequest.swift.o' '/swift3Action/spm-build/.build/release/Conversation.build/Models/Context.swift.o' '/swift3Action/spm-build/.build/release/Conversation.build/Models/MessageResponse.swift.o' '/swift3Action/spm-build/.build/release/Conversation.build/Models/InputData.swift.o' '/swift3Action/spm-build/.build/release/PersonalityInsights.build/PersonalityInsights.swift.o' '/swift3Action/spm-build/.build/release/PersonalityInsights.build/Models/TraitTreeNode.swift.o' '/swift3Action/spm-build/.build/release/PersonalityInsights.build/Models/ContentItem.swift.o' '/swift3Action/spm-build/.build/release/PersonalityInsights.build/Models/Profile.swift.o' '/swift3Action/spm-build/.build/release/NaturalLanguageClassifier.build/NaturalLanguageClassifier.swift.o' '/swift3Action/spm-build/.build/release/NaturalLanguageClassifier.build/Models/Classification.swift.o' '/swift3Action/spm-build/.build/release/NaturalLanguageClassifier.build/Models/ClassifierModel.swift.o' '/swift3Action/spm-build/.build/release/NaturalLanguageClassifier.build/Models/ClassifierDetails.swift.o' '/swift3Action/spm-build/.build/release/AlchemyVision.build/AlchemyVision.swift.o' '/swift3Action/spm-build/.build/release/AlchemyVision.build/Models/SceneText.swift.o' '/swift3Action/spm-build/.build/release/AlchemyVision.build/Models/FaceTags.swift.o' '/swift3Action/spm-build/.build/release/AlchemyVision.build/Models/ImageLink.swift.o' '/swift3Action/spm-build/.build/release/AlchemyVision.build/Models/KnowledgeGraph.swift.o' '/swift3Action/spm-build/.build/release/AlchemyVision.build/Models/ImageKeyWords.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/WeatherCompanyData.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/Models/Metadata.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/Models/Daily.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/Models/ForecastHourly.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/Models/ForecastDailyResult.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/Models/TimeSeriesResult.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/Models/TimeSeriesObservation.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/Models/ForecastHourlyResult.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/Models/Measurement.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/Models/ForecastDaily.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/Models/CurrentObservation.swift.o' '/swift3Action/spm-build/.build/release/WeatherCompanyData.build/Models/CurrentObservationResult.swift.o' '/swift3Action/spm-build/.build/release/ToneAnalyzer.build/ToneAnalyzer.swift.o' '/swift3Action/spm-build/.build/release/ToneAnalyzer.build/Models/ToneAnalysis.swift.o' '/swift3Action/spm-build/.build/release/ToneAnalyzer.build/Models/ToneCategory.swift.o' '/swift3Action/spm-build/.build/release/ToneAnalyzer.build/Models/ToneScore.swift.o' '/swift3Action/spm-build/.build/release/ToneAnalyzer.build/Models/SentenceAnalysis.swift.o'
else
  echo "Action did not compile" 1>&2
  exit 1
fi